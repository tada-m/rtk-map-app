(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{3201:(e,t,s)=>{"use strict";s.d(t,{db:()=>a,j:()=>l});var r=s(3915),d=s(5404),i=s(5317);let n=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyBhyFZVgwSjiIv7J8OjqkK9-YCpoKnTyNs",authDomain:"rtk-map-app.firebaseapp.com",projectId:"rtk-map-app",storageBucket:"rtk-map-app.firebasestorage.app",messagingSenderId:"770512095150",appId:"1:770512095150:web:897c370a971298b55f2a3f",measurementId:"G-Y267HG23R7"}),l=(0,d.xI)(n),a=(0,i.aU)(n)},3676:(e,t,s)=>{Promise.resolve().then(s.bind(s,9865))},9675:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var r=s(5155),d=s(2115),i=s(3201),n=s(5317);function l(){let[e,t]=(0,d.useState)([]),[s,l]=(0,d.useState)(!0),[o,j]=(0,d.useState)(""),[x,m]=(0,d.useState)(null);(0,d.useEffect)(()=>{(async()=>{l(!0);let e=(0,n.rJ)(i.db,"users"),s=await (0,n.GG)(e),r=[];for(let e of s.docs){var d,a,c;let t=e.data(),s=(null==(d=t.studentData)?void 0:d.studentId)||t.studentId||"",i=(null==(a=t.studentData)?void 0:a.name)||t.name||"",l=(null==(c=t.studentData)?void 0:c.class)||t.class||"",h=(await (0,n.GG)((0,n.rJ)(e.ref,"learningLog"))).docs.map(e=>e.data()),o=await (0,n.GG)((0,n.rJ)(e.ref,"problemRecords")),j=o.docs.map(e=>e.data()),x=o.docs.map(e=>e.id),m=await (0,n.GG)((0,n.rJ)(e.ref,"unitPriorities")),u=m.docs.map(e=>e.data()),p=m.docs.map(e=>e.id);r.push({uid:e.id,email:t.email||"(no email)",studentId:s,name:i,class:l,learningLog:h,problemRecords:j,problemRecordsDocNames:x,unitPriorities:u,unitPrioritiesDocNames:p})}t(r),l(!1)})()},[]);let u=e.filter(e=>{let t=o.trim().toLowerCase();return e.studentId&&e.studentId.toLowerCase().includes(t)||e.name&&e.name.toLowerCase().includes(t)||e.class&&e.class.toLowerCase().includes(t)});return(0,r.jsxs)("div",{style:{padding:24},children:[(0,r.jsx)("h1",{children:"教員用ダッシュボード"}),(0,r.jsx)("div",{style:{marginBottom:16},children:(0,r.jsx)("input",{type:"text",placeholder:"学籍番号・名前・クラスで検索",value:o,onChange:e=>j(e.target.value),style:{fontSize:16,padding:6,width:260}})}),s?(0,r.jsx)("div",{children:"読み込み中..."}):x?(0,r.jsxs)("div",{style:{marginBottom:24},children:[(0,r.jsx)("button",{onClick:()=>m(null),style:{marginBottom:12},children:"← 一覧に戻る"}),(0,r.jsxs)("h2",{children:[x.name||"(名前なし)","（",x.studentId||"-","）",x.class?" / クラス: ".concat(x.class):""]}),(0,r.jsxs)("div",{children:["メール: ",x.email]}),(0,r.jsxs)("div",{style:{marginTop:24},children:[(0,r.jsx)("h3",{children:"learningLog"}),(0,r.jsx)(a,{data:x.learningLog}),(0,r.jsx)("h3",{children:"problemRecords"}),(0,r.jsx)(c,{data:x.problemRecords,docNames:x.problemRecordsDocNames||[]}),(0,r.jsx)("h3",{children:"unitPriorities"}),(0,r.jsx)(h,{data:x.unitPriorities,docNames:x.unitPrioritiesDocNames||[]})]})]}):(0,r.jsxs)("table",{border:1,cellPadding:8,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"学籍番号"}),(0,r.jsx)("th",{children:"名前"}),(0,r.jsx)("th",{children:"クラス"}),(0,r.jsx)("th",{children:"メールアドレス"}),(0,r.jsx)("th",{children:"学習記録件数"}),(0,r.jsx)("th",{children:"問題記録件数"}),(0,r.jsx)("th",{children:"詳細"})]})}),(0,r.jsx)("tbody",{children:u.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.studentId}),(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:e.class}),(0,r.jsx)("td",{children:e.email}),(0,r.jsx)("td",{children:e.learningLog.length}),(0,r.jsx)("td",{children:e.problemRecords.length}),(0,r.jsx)("td",{children:(0,r.jsx)("button",{onClick:()=>m(e),children:"表示"})})]},e.uid))})]})]})}function a(e){let{data:t}=e;return t&&0!==t.length?(0,r.jsxs)("table",{border:1,cellPadding:6,style:{marginBottom:24,width:"100%"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"problemId"}),(0,r.jsx)("th",{children:"probremPriority"}),(0,r.jsx)("th",{children:"scs"}),(0,r.jsx)("th",{children:"scsReason"}),(0,r.jsx)("th",{children:"timestamp"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>{var s;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.problemId||""}),(0,r.jsx)("td",{children:null!=(s=e.probremPriority)?s:""}),(0,r.jsx)("td",{children:e.scs||""}),(0,r.jsx)("td",{children:e.scsReason||""}),(0,r.jsx)("td",{children:e.timestamp?e.timestamp.seconds?new Date(1e3*e.timestamp.seconds).toISOString().replace("T"," ").slice(0,19):String(e.timestamp):""})]},t)})})]}):(0,r.jsx)("div",{children:"データなし"})}function c(e){let{data:t,docNames:s}=e;return t&&0!==t.length?(0,r.jsxs)("table",{border:1,cellPadding:6,style:{marginBottom:24,width:"100%"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ドキュメント名"}),(0,r.jsx)("th",{children:"attempts"}),(0,r.jsx)("th",{children:"probremPriority"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>{var d,i;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:s[t]}),(0,r.jsx)("td",{children:null!=(d=e.attempts)?d:""}),(0,r.jsx)("td",{children:null!=(i=e.probremPriority)?i:""})]},t)})})]}):(0,r.jsx)("div",{children:"データなし"})}function h(e){let{data:t,docNames:s}=e;return t&&0!==t.length?(0,r.jsxs)("table",{border:1,cellPadding:6,style:{marginBottom:24,width:"100%"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ドキュメント名"}),(0,r.jsx)("th",{children:"priority"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>{var d;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:s[t]}),(0,r.jsx)("td",{children:null!=(d=e.priority)?d:""})]},t)})})]}):(0,r.jsx)("div",{children:"データなし"})}},9865:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(5155),d=s(2115),i=s(9675);function n(){let[e,t]=(0,d.useState)(!1),[s,n]=(0,d.useState)(""),[l,a]=(0,d.useState)("");return e?(0,r.jsx)(i.A,{}):(0,r.jsxs)("div",{style:{padding:40},children:[(0,r.jsx)("h2",{children:"教員用ダッシュボード閲覧"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"teacher"===s?(t(!0),a("")):a("パスワードが違います")},children:[(0,r.jsx)("input",{type:"password",value:s,onChange:e=>n(e.target.value),placeholder:"パスワード",style:{fontSize:18,padding:8}}),(0,r.jsx)("button",{type:"submit",style:{marginLeft:12,fontSize:18},children:"ログイン"})]}),l&&(0,r.jsx)("div",{style:{color:"red",marginTop:8},children:l})]})}}},e=>{e.O(0,[135,965,670,441,964,358],()=>e(e.s=3676)),_N_E=e.O()}]);